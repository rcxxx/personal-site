"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[4011],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var a=r.createContext({}),s=function(e){var t=r.useContext(a),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(a.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,l=e.originalType,a=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=s(n),m=o,k=d["".concat(a,".").concat(m)]||d[m]||u[m]||l;return n?r.createElement(k,i(i({ref:t},c),{},{components:n})):r.createElement(k,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=n.length,i=new Array(l);i[0]=d;var p={};for(var a in t)hasOwnProperty.call(t,a)&&(p[a]=t[a]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var s=2;s<l;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6700:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return a},metadata:function(){return s},toc:function(){return c},default:function(){return d}});var r=n(7462),o=n(3366),l=(n(7294),n(3905)),i=["components"],p={id:"ros-pcl-topic",title:"ROS \u53d1\u5e03\u548c\u8ba2\u9605 pcl \u8bdd\u9898\u6d88\u606f",sidebar_label:"pcl pub&sub topic"},a=void 0,s={unversionedId:"computer/robot/ros/ros-point-cloud/ros-pcl-topic",id:"computer/robot/ros/ros-point-cloud/ros-pcl-topic",title:"ROS \u53d1\u5e03\u548c\u8ba2\u9605 pcl \u8bdd\u9898\u6d88\u606f",description:"PCL \u5728 ros \u4e2d\u7684\u6570\u636e\u7c7b\u578b",source:"@site/docs/computer/robot/ros/ros-point-cloud/pcl-subscriber.md",sourceDirName:"computer/robot/ros/ros-point-cloud",slug:"/computer/robot/ros/ros-point-cloud/ros-pcl-topic",permalink:"/personal-site/docs/computer/robot/ros/ros-point-cloud/ros-pcl-topic",editUrl:"https://github.com/rcxxx/docs/tree/master/docs/computer/robot/ros/ros-point-cloud/pcl-subscriber.md",tags:[],version:"current",frontMatter:{id:"ros-pcl-topic",title:"ROS \u53d1\u5e03\u548c\u8ba2\u9605 pcl \u8bdd\u9898\u6d88\u606f",sidebar_label:"pcl pub&sub topic"},sidebar:"\ud83c\udf96\ufe0frobot",previous:{title:"rosbag\u53ef\u89c6\u5316",permalink:"/personal-site/docs/computer/robot/ros/ros-point-cloud/ros-rosbag-play-rviz"},next:{title:"Multi Pass Segemntation",permalink:"/personal-site/docs/computer/robot/ros/ros-point-cloud/segmentation/ros-intrinsic_velodyne_pattern"}},c=[{value:"PCL \u5728 ros \u4e2d\u7684\u6570\u636e\u7c7b\u578b",id:"pcl-\u5728-ros-\u4e2d\u7684\u6570\u636e\u7c7b\u578b",children:[{value:"\u521b\u5efa\u529f\u80fd\u5305",id:"\u521b\u5efa\u529f\u80fd\u5305",children:[],level:3},{value:"<code>subscriber</code> \u5b9e\u73b0",id:"subscriber-\u5b9e\u73b0",children:[{value:"\u521b\u5efa\u8282\u70b9",id:"\u521b\u5efa\u8282\u70b9",children:[],level:4}],level:3}],level:2},{value:"reference",id:"reference",children:[],level:2}],u={toc:c};function d(e){var t=e.components,n=(0,o.Z)(e,i);return(0,l.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"pcl-\u5728-ros-\u4e2d\u7684\u6570\u636e\u7c7b\u578b"},"PCL \u5728 ros \u4e2d\u7684\u6570\u636e\u7c7b\u578b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://wiki.ros.org/pcl/Overview"},"PCL Overview \u2014\u2014 ROS Wiki"))),(0,l.kt)("p",null,"\u5148\u5728\u6b64\u94fe\u63a5\u4e2d\u5bf9\u6240\u9700\u8981\u7684\u6570\u636e\u7c7b\u578b\u7a0d\u4f5c\u4e86\u89e3"),(0,l.kt)("h3",{id:"\u521b\u5efa\u529f\u80fd\u5305"},"\u521b\u5efa\u529f\u80fd\u5305"),(0,l.kt)("p",null,"\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"ros")," \u5de5\u4f5c\u7a7a\u95f4\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"src/")," \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u529f\u80fd\u5305 ",(0,l.kt)("inlineCode",{parentName:"p"},"pcl_test")),(0,l.kt)("p",null,"\u8be5\u529f\u80fd\u5305\u6709\u56db\u4e2a\u4f9d\u8d56\u9879 ",(0,l.kt)("inlineCode",{parentName:"p"},"pcl_conversions"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"pcl_ros"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"roscpp"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"sensor_msgs")," "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"cd src/\ncatkin_create_pkg pcl_test pcl_conversions pcl_ros roscpp sensor_msgs\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7f16\u8bd1\u529f\u80fd\u5305")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"cd ..\ncatkin_make\n")),(0,l.kt)("h3",{id:"subscriber-\u5b9e\u73b0"},(0,l.kt)("inlineCode",{parentName:"h3"},"subscriber")," \u5b9e\u73b0"),(0,l.kt)("h4",{id:"\u521b\u5efa\u8282\u70b9"},"\u521b\u5efa\u8282\u70b9"),(0,l.kt)("p",null,"\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"src/pcl_test/src")," \u76ee\u5f55\u4e0b\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"p"},"pcl_topic.cpp")," \u6587\u4ef6"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5305\u542b\u5934\u6587\u4ef6")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <ros/ros.h>\n/*---< PCL >---*/\n#include <pcl_ros/point_cloud.h>\n#include <pcl/point_types.h>\n")),(0,l.kt)("p",null,"\u6211\u4eec\u76ee\u7684\u662f\u5c06\u63a5\u6536\u5230\u5e95\u70b9\u4e91\u6570\u636e\u5904\u7406\u540e\u518d\u53d1\u5e03\u51fa\u53bb"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u60f3\u628a\u70b9\u4e91\u6570\u636e\u6570\u636e\u5728 ",(0,l.kt)("inlineCode",{parentName:"li"},"rviz")," \u4e2d\u53ef\u89c6\u5316\uff0c\u8981\u5c06\u8981\u53d1\u5e03\u7684\u70b9\u4e91\u6570\u636e\u8f6c\u6362\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"sensor_msgs::PointCloud2")," \u5f62\u5f0f\uff0c\u53ef\u89c6\u5316\u7684\u65f6\u5019\u4e0d\u4f1a\u51fa\u73b0\u8b66\u544a"),(0,l.kt)("li",{parentName:"ul"},"\u5305\u542b\u5934\u6587\u4ef6")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <sensor_msgs/PointCloud2.h>\n")),(0,l.kt)("p",null,"\u8981\u5c06 ",(0,l.kt)("inlineCode",{parentName:"p"},"sensor_msgs::PointCloud2")," \u8f6c\u6362\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"pcl")," \u4e2d\u7684\u70b9\u4e91\u683c\u5f0f\uff0c\u8fd8\u9700\u8981\u7528\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"pcl_conversions")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5305\u542b\u5934\u6587\u4ef6")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <pcl_conversions/pcl_conversions.h>\n")),(0,l.kt)("p",null,"\u5b9a\u4e49 ",(0,l.kt)("inlineCode",{parentName:"p"},"publihser")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"callback")," \u56de\u8c03\u51fd\u6570\uff0c\u6267\u884c\u8ba2\u9605\u8bdd\u9898\u4e4b\u540e\u7684\u64cd\u4f5c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},'ros::Publisher pub;\n\nvoid callback(const sensor_msgs::PointCloud2ConstPtr& input_msg)\n{\n  pcl::PCLPointCloud2* point_cloud = new pcl::PCLPointCloud2;\n  pcl_conversions::toPCL(*input_msg, *point_cloud);\n\n  // \u8fdb\u884c\u5904\u7406\n  /*--- code ---*/\n  // Publish\n  sensor_msgs::PointCloud2 output_msg;\n  pcl_conversions::fromPCL(*point_cloud, output_msg);\n  pub.publish(output_msg);\n  std::cout<<"published  \ud83d\udcad\ud83d\udcad\ud83d\udcad"<<std::endl;\n  ROS_INFO("Cloud: width = %d, height = %d\\n", output_msg.width, output_msg.height);\n}\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u91cc\u8ba2\u9605 ",(0,l.kt)("inlineCode",{parentName:"li"},"sensor_msgs::PointCloud2")," \u7684\u6d88\u606f\u7c7b\u578b\uff0c\u5e76\u8f6c\u6362\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"pcl::PCLPointCloud2")," \u7c7b\u578b\u6267\u884c\u5904\u7406\uff08\u5047\u8bbe\uff09\uff0c\u518d\u8f6c\u6362\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"sensor_msgs::PointCloud2")," \u6267\u884c\u53d1\u5e03")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp",metastring:'title="main"',title:'"main"'},'int main(int argc, char** argv){\n  ros::init(argc, argv, "pcl_topic");\n\n  ros::NodeHandle nh;\n\n  // \u8ba2\u9605\u8bdd\u9898\uff0c\u6267\u884c\u56de\u8c03\u51fd\u6570 \n  // "velodyne_points" \u6362\u4e3a\u4f60\u9700\u8981\u8ba2\u9605\u7684\u8bdd\u9898\u540d\n  ros::Subscriber sub = nh.subscribe("velodyne_points", 1, callback);\n  pub = nh.advertise<sensor_msgs::PointCloud2>("output", 1);\n\n  ros::spin();\n\n  return 0;\n}\n')),(0,l.kt)("p",null,"\u5728\u529f\u80fd\u5305\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"build")," \u90e8\u5206\u52a0\u5165"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-CMakeLists"},"add_executable(pcl_topic src/pcl_topic.cpp)\ntarget_link_libraries(pcl_topic ${catkin_LIBRARIES})\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7f16\u8bd1\u529f\u80fd\u5305")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"catkin_make\n")),(0,l.kt)("p",null,"\u8fd0\u884c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"source devel/setup.bash\nroscore\nrosrun pcl_test pcl_topic\n")),(0,l.kt)("p",null,"\u7136\u540e\u8fd0\u884c\u4e00\u4e2a\u76f8\u5e94\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"bag")," \u5305\uff0c\u6267\u884c\u53d1\u5e03"),(0,l.kt)("p",null,"\u6210\u529f\u8ba2\u9605\u8bdd\u9898"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://pictures-1304295136.cos.ap-guangzhou.myqcloud.com/screenshot/ubuntu/ros/pcl_topic_sub.png",alt:null})),(0,l.kt)("p",null,"\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"rviz")," \u4e2d\u53ef\u89c6\u5316"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://pictures-1304295136.cos.ap-guangzhou.myqcloud.com/screenshot/ubuntu/ros/pcl_topic_rviz.png",alt:null})),(0,l.kt)("h2",{id:"reference"},"reference"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://dabit-industries.github.io/turtlebot2-tutorials/13-ROSPCL.html"},"PCL with ROS using C++ \u2014\u2014 turtlebot2-tutorials")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://wiki.ros.org/pcl/Overview"},"PCL Overview \u2014\u2014 ROS Wiki")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://answers.ros.org/question/325030/how-to-read-a-point-cloud-pcd-file-and-send-it-to-a-rosbag/"},"How to read a point cloud (.pcd) file and send it to a rosbag")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://wiki.ros.org/pcl/Tutorials"},"How to use a PCL tutorial in ROS \u2014\u2014 ROS Wiki")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.guyuehome.com/25024"},"ROS\u7cfb\u7edf\u5b66\u4e6011---\u70b9\u4e91\u6570\u636e\u7684\u53d1\u9001\u548c\u63a5\u6536")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://cloud.tencent.com/developer/article/1692529"},"ROS\u4e0ePCL\u4e2d\u70b9\u4e91\u6570\u636e\u4e4b\u95f4\u7684\u8f6c\u6362")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://cloud.tencent.com/developer/article/1477011"},"\u5982\u4f55\u5728ROS\u4e2d\u4f7f\u7528PCL\u2014\u6570\u636e\u683c\u5f0f\uff081\uff09")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://sinnammanyo.cn/docs/docs/ros/ros-point-cloud/ros-rosbag-play-rviz"},"\u5728 rviz \u4e2d\u53ef\u89c6\u5316 rosbag \u6570\u636e"))))}d.isMDXComponent=!0}}]);